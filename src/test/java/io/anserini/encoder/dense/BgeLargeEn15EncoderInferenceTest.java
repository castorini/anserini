/*
 * Anserini: A Lucene toolkit for reproducible information retrieval research
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package io.anserini.encoder.dense;

import ai.onnxruntime.OrtException;
import org.junit.Test;

import java.io.IOException;
import java.net.URISyntaxException;

import static org.junit.Assert.assertTrue;

public class BgeLargeEn15EncoderInferenceTest extends DenseEncoderInferenceTest {
  private static final DenseExampleOutputPair[] EXAMPLES = {
      new DenseExampleOutputPair(
          "In the dawn of the 21st century, humanity stands on the brink of one " +
              "of the most transformative periods in history: the rise of artificial " +
              "intelligence (AI). This technological revolution promises to redefine " +
              "the way we live, work, and interact with the world around us. However, " +
              "as with any major technological advancement, the implications of AI for " +
              "society are complex, nuanced, and not entirely predictable. This essay " +
              "explores the potential impacts of AI on various aspects of human life, " +
              "including employment, ethics, personal privacy, and societal structures.",
            new float[]{  -0.018404242f, 0.0037321134f, 0.0020308741f, 0.0038027568f, 0.015777042f, -0.01026127f, -0.040145434f, 0.0031787476f, 0.003222045f, 0.017625399f, -0.008739569f, -0.008917309f, 0.008581042f, -0.004037911f, -0.0051657204f, -0.018695608f, -0.02284498f, -0.012473062f, 0.011930298f, 0.009790112f, 0.01211579f, -0.004475172f, -0.04834234f, -0.024516687f, -0.039187465f, 0.03724263f, 0.011974743f, 0.016604323f, 0.040935386f, 0.039050482f, -0.03394188f, -0.009761407f, -0.007974696f, -0.038189154f, -0.012884099f, -0.029604502f, 0.026262786f, -0.09411862f, -0.03894124f, -0.048096757f, 0.029509693f, 0.0076893843f, 0.02232726f, -0.088072956f, -0.045043565f, 0.023844708f, 0.030041581f, -0.017787442f, -0.026362462f, -0.027305812f, -0.013878444f, 0.018342402f, 0.010589251f, 0.019541286f, 0.0010175513f, -0.032139104f, -0.0035446708f, 0.0053481464f, -0.03137583f, 0.010504433f, 0.018905943f, 0.038296983f, 0.011886959f, -0.013794507f, 0.010503698f, 0.0439422f, -0.009643565f, -0.020959834f, 0.0008714929f, 0.0078900475f, -0.043940477f, -0.0314438f, -0.008551851f, -0.026262673f, -0.033893142f, -0.0033194597f, 0.0006252357f, -0.0040683583f, 0.008139211f, -0.048841383f, -0.004588559f, 0.043272693f, -0.030124635f, -0.011463558f, -0.023243671f, -0.0011403309f, 0.0040471754f, 0.03042643f, 0.008630643f, -0.015456994f, -0.0138153685f, 0.043064576f, -0.013568415f, 0.010187352f, -0.027258294f, 0.045690633f, -0.012749212f, 0.033108156f, -0.03503805f, -0.023777375f, 0.025466919f, 0.06937781f, -0.014032281f, 0.061094213f, -0.049187828f, 0.0071950727f, 0.020561619f, -0.005665148f, 0.0329191f, -0.06401528f, -0.038230635f, 0.046130966f, -0.005571761f, -0.015251669f, -0.016665924f, 0.06996165f, -0.0388868f, 0.013113251f, -0.029084926f, 0.009383454f, 0.0032963932f, -0.0034071621f, 0.060850415f, -0.029822072f, 0.008380009f, -0.042986825f, -0.017154835f, 0.02458355f, -0.03350611f, 0.024822533f, 0.008334885f, 0.010176233f, -0.014711956f, 0.033794943f, -0.049318608f, 0.013324862f, 0.020712994f, 0.03162591f, 0.004578866f, -0.03624701f, 0.028305005f, -0.020234387f, -0.01170423f, 0.07068065f, -0.011642304f, -0.032651573f, -0.043226745f, 0.069943324f, -0.016672028f, -0.039077897f, -0.027117694f, 0.055991214f, 0.021715375f, 0.0021719155f, -0.0020924509f, -0.05350952f, -0.03830201f, -0.003815406f, 0.0023684914f, 0.011780161f, -0.049680162f, 0.015028149f, -0.029016819f, 0.03862245f, -0.032899708f, 0.03690003f, -0.061030928f, 0.010496287f, -0.017295416f, -0.034172673f, 0.05390047f, -0.0023555553f, -0.017978005f, 0.021699265f, 0.057203118f, 0.0002238841f, 0.074454255f, -0.013920318f, 0.035947062f, 0.0072542173f, -0.038629457f, 0.007124448f, -0.0182146f, 0.03877157f, -0.005846138f, 0.026124625f, -0.044140033f, 0.0069581415f, -0.025235586f, -0.008029576f, 0.030789146f, 0.028794508f, -0.05705841f, 0.025618423f, 0.0042227223f, 0.026525032f, -0.037681542f, 0.0023495897f, 0.024444161f, -0.042325467f, -0.017626947f, 0.017597586f, 0.014209872f, 0.041118205f, -0.035845384f, 0.04907266f, -0.009290878f, 0.054662198f, -0.07533487f, 0.029061202f, 0.025248071f, -0.014845875f, -0.026114598f, 0.043426815f, 0.019833062f, 0.005535106f, -0.01636045f, 0.0051880274f, -9.170713e-06f, 0.0036872164f, -0.0075196144f, -0.013919136f, -0.019724932f, -0.029952891f, -0.008064716f, -0.007083168f, 0.015390089f, 0.02593321f, -0.019711893f, -0.01447427f, 0.060982477f, 0.0075748707f, 0.005147605f, -0.0049385023f, -0.0013008602f, 0.005686415f, -0.027566276f, 0.051623415f, -0.009461111f, -0.0036912535f, 0.013730984f, 0.0067371866f, 0.082571365f, 0.045900095f, -0.05408312f, 0.006036032f, 0.0131707415f, -0.005716422f, 0.028376121f, 0.046616204f, -0.023274446f, 0.0351192f, 0.0069345175f, -0.019708231f, -0.028114123f, 0.026312131f, 0.03909524f, 0.0025510336f, -0.0032162534f, -0.06488824f, -0.014990695f, 0.06363395f, 0.03513545f, 0.0042129424f, 0.07020785f, 0.028018659f, 0.032695245f, 0.042981673f, -0.05870742f, -0.025987081f, -0.05654427f, -0.044129577f, -0.017993469f, -0.012806276f, -0.020625778f, -0.023039691f, 0.04435543f, -0.057337064f, 0.021471996f, -0.017443873f, -0.02566865f, -0.0043841116f, 0.014552136f, 0.025709117f, -0.004674245f, -0.026861072f, -0.0759657f, -0.011957552f, 0.002581557f, 0.056197736f, 0.012604291f, 0.012683205f, -0.028601816f, -0.039829988f, 0.0019269378f, -0.012632801f, 0.020578053f, 0.006163153f, -0.04673642f, -0.04550546f, 0.025469821f, 0.030080285f, -0.032418974f, -0.021440294f, -0.02079964f, 0.026892565f, 0.01789922f, 0.027113985f, 0.04316973f, -0.027650462f, -0.016310463f, 0.019141065f, -0.010214623f, 0.043698013f, 0.006826918f, 0.006824387f, -0.01261437f, -0.0046787546f, -0.0006879203f, -0.04105197f, -0.055757597f, -0.0035255447f, 0.015362687f, 0.003903369f, 0.004953711f, -0.0042371196f, 0.051093336f, -0.11192824f, 0.015563342f, -0.043615144f, -0.05746181f, -0.0062148445f, -0.018943464f, 0.048427187f, 0.017704876f, 0.005981168f, -0.0008041944f, -0.018170211f, -0.03162103f, -0.0022804847f, -0.0026663735f, -0.0021987637f, 0.012403605f, 0.0026232987f, -0.031319495f, 0.014712554f, 0.0921208f, 0.013694559f, 0.040714752f, -0.01869247f, 0.02884159f, 0.0063549234f, -0.018538283f, -0.04269613f, 0.027651217f, 0.022875518f, -0.019816697f, -0.00067379104f, -0.002871298f, -0.0077663143f, 0.011086778f, 0.023888154f, -0.0411186f, -0.0076220604f, -0.05380774f, 0.018130763f, 0.00035237285f, -0.0095538655f, 0.03197902f, 0.00037944582f, 0.049421906f, 0.0033319949f, -0.00019576518f, 0.014796782f, -0.028491251f, 0.009647562f, 0.043375462f, -0.029126683f, 0.0229574f, -0.034184538f, -0.0032676705f, -0.0006375476f, 0.034007706f, 0.02251268f, -0.02015432f, 0.0169335f, -0.062421482f, 0.06174857f, 0.008817155f, -0.012058166f, 0.0052699414f, -0.024007201f, -0.012231348f, 0.0068943226f, -0.04811921f, -0.04807551f, 0.07016879f, 0.02146975f, 0.022011777f, -0.033261858f, 0.04584713f, -0.038909998f, -0.00046266627f, 0.017953182f, 0.007972604f, -0.008981781f, -0.013069301f, 0.032487553f, -0.004219821f, 0.017994234f, 0.0037686555f, -0.010857763f, 0.04020455f, 0.008734464f, 0.016015602f, 0.0010197395f, 0.0077264635f, -0.022290317f, -0.010693796f, -0.023054715f, 0.01309366f, 0.028927008f, -0.035937186f, 0.039273094f, 0.0019755487f, 0.011659059f, 0.01248273f, -0.07156195f, 0.04068452f, 0.02239988f, -0.019701397f, -0.0750655f, 0.008798836f, -0.051327903f, -0.010734484f, -0.011810128f, 0.037126362f, -0.04843034f, 0.0104027735f, -0.032992862f, 0.008355743f, 0.046453167f, 0.024003265f, -0.023325305f, -0.016628768f, -0.045064155f, -0.0106049f, 0.027106546f, -0.028961549f, -0.04993128f, 0.025165498f, -0.061518084f, 0.011849777f, -0.037938565f, 0.03095618f, -0.020816535f, -0.008502882f, 0.0013467574f, -0.00033906804f, -0.0022195294f, -0.01033506f, 0.024306597f, 0.018806078f, -0.06581871f, -0.02846352f, 0.03263326f, -0.014820367f, 0.006028601f, 0.009886459f, -0.01718655f, -0.0059519834f, 0.033070836f, 0.023777962f, -0.009871271f, -0.009182058f, -0.016028402f, 0.0053296164f, -0.0036704026f, 0.010656156f, -0.010592502f, -0.021844774f, 0.012224755f, 0.0073207906f, 0.0074228356f, -0.037241846f, -0.028342905f, 0.003460449f, 0.013027269f, -0.012480337f, 0.019061046f, 0.0058595967f, 0.0039165816f, -0.0045969365f, 0.008806813f, -0.0075387596f, 0.01819162f, 0.033016756f, -0.06467966f, -0.003849287f, -0.038373232f, 0.06266507f, -0.034415554f, -0.0052444595f, -0.008522196f, 0.0021726806f, -0.051403053f, -0.04834472f, -0.016332112f, 0.03412639f, -0.00046055525f, -0.009376546f, -0.028493961f, 0.004880036f, 0.025186142f, 0.034460243f, -0.01330663f, 0.023837745f, -0.012093029f, 0.016896104f, 0.04985399f, 0.045217153f, -0.047110315f, 0.002026936f, 0.06732037f, -0.033131912f, -0.010632376f, 0.00924925f, -0.031048989f, -0.003651576f, -0.11245334f, -9.050433e-05f, -0.019452846f, 0.010018405f, -0.01181038f, 0.016660882f, -0.016891845f, 0.047165222f, -0.010913169f, 0.003301635f, -0.019920357f, -0.051541883f, -0.0006958936f, -0.024536902f, -0.007606549f, -0.024159849f, -0.043507308f, -0.009834821f, 0.036541358f, -0.013180752f, -0.022595625f, 0.014408931f, -0.015589329f, -0.026675131f, 0.019986568f, -0.035472054f, -0.01743573f, -0.023030745f, 0.031926617f, -0.0040202965f, 0.02623178f, -0.02546457f, 0.029469114f, 0.04205027f, -0.027885437f, -0.011968897f, -0.023317011f, 0.010789519f, 0.0052524977f, 0.03711365f, -0.044149745f, -0.010942575f, -0.0017775922f, -0.010935132f, 0.048108f, 0.0056888275f, -0.026639266f, 0.041537303f, -0.03519099f, -0.041000344f, -0.014964407f, 0.0032983369f, -0.00012684386f, -0.020719508f, -0.010871322f, 0.013490331f, -0.08739712f, -0.0022810367f, 0.059477005f, -0.02507179f, 0.001219617f, 0.007177645f, 0.02803876f, 0.001957753f, -0.011921987f, -0.05018989f, 0.0074585984f, -0.0035988542f, -0.026660612f, -0.009734435f, -0.011680969f, -0.027953703f, 0.042409673f, 0.05871897f, -0.031875357f, 0.05662205f, -0.014730772f, -0.052646752f, -0.042182513f, 0.00012896673f, -0.029821914f, 0.02928465f, 0.054140307f, 0.037407216f, -0.008563512f, 0.07129579f, -0.0073741637f, -0.03863944f, -0.037888724f, 0.039416574f, 0.040779665f, -0.029684583f, 0.028539315f, 0.041007556f, -0.03336522f, -0.026672548f, -0.053361814f, -0.0023301083f, 0.017446155f, -0.055344686f, 0.022726387f, 0.050729673f, 0.039028753f, 0.020810625f, -0.0052075954f, 0.0028551472f, 0.044798605f, 0.02637272f, 0.031217951f, 0.0077864095f, 0.00025797184f, 0.051383074f, 0.009440648f, -0.0005713583f, -0.034201127f, -0.008009659f, 0.0067784367f, -0.024406396f, 0.04848277f, -0.038334556f, -0.03804374f, 0.021800684f, -0.02297341f, 0.023851419f, -0.04689066f, 0.0058271056f, 0.019307394f, -0.001194841f, -0.029625539f, -0.039834008f, 0.02603804f, -0.006204133f, 0.027487049f, -0.01577873f, 0.009641499f, 0.03184746f, 0.02827857f, -0.038228285f, -0.031207522f, -0.021004017f, -0.06653272f, -0.0038772833f, -0.00021421637f, 0.040190097f, 0.0043825526f, 0.035189953f, 0.020077648f, -0.015390055f, -0.06832266f, 0.066939995f, -0.014206168f, -0.025261497f, -0.022684826f, -0.014013218f, -0.0041899425f, -0.010712864f, -0.014031548f, -0.043403164f, 0.015791427f, 0.052226413f, 0.0064886f, 0.01980137f, -0.019962974f, 0.021912687f, -0.037806805f, 0.006094542f, 0.005644491f, 0.007495778f, 0.03008879f, -0.009462027f, 0.0067425813f, 0.029096445f, 0.016763529f, -0.0018012538f, 0.038005915f, -0.035661533f, -0.00702654f, 0.009370268f, 0.016165974f, 0.041039154f, -0.04387028f, 0.008477707f, -0.044308767f, 0.030911896f, -0.024687901f, -0.06480806f, -0.0027409014f, -0.0065454245f, -0.00023209269f, -0.01854191f, 0.0092570335f, 0.049762588f, 0.021044558f, 0.048255134f, -0.0171009f, 0.045081947f, 0.045077097f, -0.033579838f, 0.018407643f, -0.025222074f, 0.011427425f, -0.057569567f, -0.035956662f, 0.022058828f, -0.044610698f, -0.010856452f, 0.025727523f, -0.04571497f, -0.01062806f, 0.019983992f, 0.0044770306f, 0.06873512f, 0.005314902f, 0.033492036f, 0.051814847f, 0.018019322f, -0.034649037f, -0.0024885184f, -0.024603019f, -0.04434554f, 0.03012513f, 0.009456971f, 0.0054850415f, -0.0019814235f, -0.019241303f, 0.026671728f, 0.00967017f, 0.031566568f, 0.012229699f, 0.029566556f, 0.0012591697f, 0.027575595f, -0.028498385f, -0.05687543f, -0.031191694f, 0.017978644f, -0.011487188f, -0.05040618f, 0.032164317f, -0.017974013f, -0.017566094f, 0.0027689177f, -0.014489709f, -0.017131759f, 0.010102807f, 0.020696612f, -0.007695099f, 0.037014768f, -0.052174594f, 0.024944287f, 0.036006484f, 0.021795f, 0.020102397f, 0.028095393f, 0.037564714f, -0.066154435f, -0.022145452f, 0.008267539f, 0.01603959f, -0.026699582f, 0.02189613f, -0.0020530317f, 0.0267196f, -0.015060446f, -0.0047633876f, 0.0002133902f, 0.032746457f, -0.0044775647f, -0.009617072f, 0.03720995f, 0.025654601f, 0.061261173f, 0.0025654957f, 0.00782716f, -0.02843813f, 0.018098382f, -0.045291744f, -0.007778202f, -0.027374666f, 0.046622586f, -0.03717246f, -0.018728029f, 0.034712486f, 0.0012118368f, 0.0052425927f, -0.015510313f, -0.051800434f, 0.043216832f, 0.008299724f, -0.020759784f, -0.002782305f, 0.020601902f, 0.03997736f, 0.01705247f, 0.031211413f, 0.02189561f, 0.06062977f, 0.00736248f, 0.007196973f, 0.04002672f, -0.017813563f, -0.018058546f, 0.0014092032f, 0.0061505814f, 0.0507238f, 0.0027586883f, 0.02036833f, -0.02245084f, 0.025983775f, 0.067363314f, -0.015093611f, -0.004353555f, -0.019288244f, -0.031237308f, -0.019664917f, -0.011589581f, 0.048936166f, -0.029201303f, 0.00093221624f, 0.04258273f, -0.0358663f, -0.0065194177f, 0.03682269f, 0.008893602f, 0.021124108f, 0.05271517f, 0.027003279f, -0.0067385533f, 0.06635519f, 0.07492796f, -0.037524205f, -0.016666094f, 0.0046455553f, -0.048951857f, -0.011629466f, -0.013179286f, -0.007717812f, -0.025343226f, 0.0069201277f, -0.017253129f, -0.035469215f, -0.010191606f, 0.0058442503f, -0.011375103f, -0.0506809f, 0.020334953f, 0.0160235f, 0.009628834f, -0.01668226f, 0.028857823f, -0.0076945466f, 0.02187446f, 0.01721645f, -0.023993474f, 0.009226235f, -0.07850899f, 0.04485247f, 0.04083879f, -0.060250424f, -0.024397079f, -0.06609385f, -0.0071573392f, 0.0014161596f, 0.011064239f, -0.038129926f, 0.014684634f, 0.032294933f, 0.0069454066f, -0.006085907f, -0.032148536f, -0.0141466465f, 0.03455893f, 0.036021397f, 0.028561953f, 0.05334392f, 0.01639963f, 0.017934876f, -0.0078352f, -0.018411923f, 0.03245643f, 0.011250549f, -0.012731025f, -0.0076903068f, -0.009449254f, -0.007758856f, -0.0037281804f, 0.046744395f, 0.051506594f, 0.016313698f, -0.00015904693f, -0.054018974f, -0.029895324f, -0.054121118f, 0.03395542f, -0.051841587f, 0.04990548f, -0.020645792f, 0.03716527f, 0.004607085f, -0.04558896f, 0.23674613f, 0.06918817f, 0.0030167133f, -0.02973977f, 0.023935834f, 0.0542017f, 0.029822173f, 0.009242156f, 0.036684103f, -0.021556871f, 0.020573337f, -0.02802355f, -0.005239653f, -0.0043775947f, -0.005208025f, 0.029616956f, -0.025334762f, -0.010544717f, -0.012991742f, -0.014860244f, -0.08751557f, -0.0030780481f, 0.016966656f, -0.029599901f, 0.036399253f, 0.032721035f, 0.050569713f, 0.0012878842f, -0.009913009f, -0.017113702f, -0.033379935f, -0.033484228f, -0.009889649f, -0.035420712f, -0.018830897f, 0.031805724f, -0.017108528f, -0.023521481f, -0.028000865f, 0.045526266f, 0.0048797037f, -0.007528836f, -0.009572808f, -0.0017733609f, -0.018166028f, 0.028931526f, 0.0017232478f, -0.003418607f, 0.028148012f, -0.04633689f, 0.029663967f, -0.05688986f, 0.0035464829f, -0.012978504f, 0.037134018f, -0.010618957f, -0.026996244f, 0.0032299014f, -0.04665011f, 0.018280046f, 0.009559648f, -0.028831078f, -0.041835055f, 0.02214447f, 0.007243625f, 0.053229336f, 0.011010906f, 0.02360584f, -0.007594604f, 0.013003181f, 3.8309878e-05f, 0.016477246f, -0.05293961f, -0.04670386f, 0.0009717291f, 0.033002708f, -0.008350208f, 0.029254388f, 0.010622485f, -0.036076795f, -0.02239501f, -0.0076680714f, -0.028565126f, 0.023286916f, 0.02559293f, 0.022191692f, 0.0024500738f, 0.0051355846f, -0.0032656526f, 0.02243161f, 0.028430013f, 0.006235202f, 0.03310496f, -0.022951478f, -0.016527642f})
    };

  @Test
  public void testExamples() throws OrtException, IOException, URISyntaxException {
    try(BgeLargeEn15Encoder encoder = new BgeLargeEn15Encoder()) {
      assertTrue(encoder.getModelPath().endsWith("bge-large-en-v1.5-optimized.onnx"));
      super.testExamples(EXAMPLES, encoder);
    }
  }
}
