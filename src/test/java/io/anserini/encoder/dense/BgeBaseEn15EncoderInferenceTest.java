/*
 * Anserini: A Lucene toolkit for reproducible information retrieval research
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package io.anserini.encoder.dense;

import ai.onnxruntime.OrtException;
import org.junit.Test;

import java.io.IOException;
import java.net.URISyntaxException;

import static org.junit.Assert.assertTrue;

public class BgeBaseEn15EncoderInferenceTest extends DenseEncoderInferenceTest {
  static private final String MODEL_URL = "https://rgw.cs.uwaterloo.ca/pyserini/data/bge-base-en-v1.5-optimized.onnx";
  static private final String MODEL_NAME = "bge-base-en-v1.5-optimized.onnx";

  private static final DenseExampleOutputPair[] EXAMPLES = {
      new DenseExampleOutputPair(
          "In the dawn of the 21st century, humanity stands on the brink of one " +
              "of the most transformative periods in history: the rise of artificial " +
              "intelligence (AI). This technological revolution promises to redefine " +
              "the way we live, work, and interact with the world around us. However, " +
              "as with any major technological advancement, the implications of AI for " +
              "society are complex, nuanced, and not entirely predictable. This essay " +
              "explores the potential impacts of AI on various aspects of human life, " +
              "including employment, ethics, personal privacy, and societal structures.",
          new float[] {0.044444107f, 0.020188615f, 0.021676198f, -0.010987711f, 0.06378974f, -0.03154505f, 0.05383968f, 0.049584307f, 0.018384006f, -0.038459595f, -0.026186362f, -0.033443756f, -0.0827261f, -0.03494365f, 0.013560826f, 0.0147585375f, 0.0348203f, 0.0039112424f, -0.067237586f, -0.011843291f, -0.038932417f, 0.024738181f, 0.030087695f, 0.016847322f, 0.057047717f, -0.052645404f, -0.0071979207f, 0.035666183f, -0.049441915f, 0.042889055f, 0.018282717f, -0.046655145f, -0.017398521f, -0.033759076f, -0.0044302195f, -0.002462212f, -0.053565446f, -0.04336273f, -0.001424113f, 0.035261977f, -0.06204124f, 0.020451674f, -0.019475792f, -0.01040331f, -0.028497098f, -0.0128711015f, -0.04396739f, 0.048806682f, -0.0019573541f, 0.003307816f, -0.050365012f, -0.04052855f, 0.010844705f, -0.047391627f, 0.033798125f, 0.08214952f, 0.013244813f, -0.06613564f, -0.027851608f, -0.03600759f, 0.0098869875f, 0.010447014f, 0.016612226f, 0.0014661589f, -0.016048834f, -0.024444299f, 0.027335623f, -0.00795283f, -0.028180147f, 0.0043456326f, -0.014021745f, -0.012024941f, -0.012351788f, -0.03416713f, -0.04437225f, -0.05839672f, -0.0011238079f, 0.012556844f, 0.0035486226f, -0.015771974f, 0.021248404f, 0.042590484f, -0.0052889814f, -0.0045047835f, 0.025685662f, -0.01946161f, 0.051803034f, 0.024839189f, -0.015922181f, 0.01968382f, -0.0048770737f, -0.055133514f, 0.009266837f, 0.098575f, -0.0097405175f, 0.051310465f, 0.004870541f, 0.02728432f, -0.03766221f, 0.0051170783f, -0.0066314735f, -0.011998918f, 0.017030528f, -0.0030250447f, -0.054320697f, 0.016424594f, 0.022563739f, -0.058378547f, 0.027743148f, -0.0024546443f, -0.054681677f, 0.029879384f, 0.037069365f, -0.010963535f, -0.07874743f, 0.028217847f, 0.018727465f, 0.012753929f, 0.011320962f, 0.03534469f, 0.03251151f, -0.0068447064f, 0.00082159584f, 0.040782623f, -0.02774978f, -0.0076486086f, -0.0191092f, -0.03424529f, -0.0022548556f, -0.023231387f, -0.012745056f, 0.03871204f, -0.01477834f, -0.009071136f, -0.047171555f, 0.04089857f, 0.007558735f, 0.04184103f, 0.049155153f, 0.019691404f, -0.00027745383f, -0.1061465f, 0.041936964f, -0.06605617f, 0.033003528f, -0.027735136f, -0.011413265f, 0.02577669f, -0.029449154f, -0.028697086f, -0.026986977f, 0.048479978f, 0.017887956f, -0.04671945f, 0.08306945f, 0.03956852f, 0.10094274f, 0.02032997f, -0.03796669f, 0.0007436166f, 0.025004761f, 0.05146571f, -0.02035088f, -0.05096087f, 0.010926636f, -0.014912371f, -0.019778918f, -0.043063425f, -0.0008730605f, 0.010560359f, -0.035236675f, 0.008607492f, 0.02033636f, -0.050519053f, -0.02335564f, -0.0021807132f, 0.06420522f, 0.024893109f, -0.025218874f, 0.016281983f, -0.062053658f, 0.00741033f, -0.016148519f, 0.017174708f, -0.047950346f, -0.00703624f, 0.07177174f, 0.030278075f, 0.015007436f, -0.017157245f, -0.05882055f, -0.0551217f, 0.024792796f, 0.0044898516f, 0.05744015f, -0.06341667f, 0.026238851f, 0.07359728f, -0.021277297f, 0.04410811f, -0.02411926f, 0.023846416f, 0.006553793f, -0.035872407f, -0.03766143f, 0.007837293f, 0.00019598023f, -0.0070596086f, -0.027650474f, 0.047288988f, -0.017091544f, 0.014303863f, -0.0033791757f, 0.04994811f, 0.0016364561f, -0.02010693f, 0.022723485f, 0.010442082f, -0.0002857291f, -0.025370209f, 0.036332536f, -0.030998107f, 0.06146159f, 0.010152346f, 0.010172351f, 0.12551962f, 0.038273003f, -0.05628432f, -0.006486053f, 0.034797095f, 0.0023416537f, 0.016524687f, 0.02054552f, -0.023125652f, -0.00013248186f, 0.0012293056f, -0.0032004314f, 0.007320611f, 0.010754215f, -0.034699805f, 0.019838672f, 0.06106837f, -0.0003303846f, 0.04852673f, 0.014172199f, 0.00270479f, 0.028059838f, -0.034159508f, -0.01143568f, -0.0036613885f, -0.067900136f, 0.0031496861f, 0.02238307f, -0.011116338f, -0.020515446f, -0.013286371f, 0.034981992f, 0.02516131f, 0.034654163f, -0.0133621665f, 0.010926878f, 0.016710535f, -0.0368887f, -0.022981849f, -0.018753614f, -0.080582425f, -0.03869722f, -0.069741145f, 0.015791753f, -0.037175167f, 0.03451221f, -0.048488136f, 0.016552215f, 0.016646128f, 0.069355965f, 0.034331996f, 0.014803913f, 0.0020647875f, -0.009309683f, 0.009463803f, 0.011946647f, 0.056943472f, -0.028007904f, -0.031445667f, 0.048195884f, -0.03493223f, -0.05082236f, -0.020045599f, -0.010018195f, 0.02738573f, -0.00032905932f, 0.033100337f, -0.018716995f, -0.024901012f, 0.046334233f, 0.037836965f, 0.043289255f, -0.03634769f, 0.0017666317f, -0.022233794f, -0.015282291f, 0.0423618f, 0.007778795f, -0.0032131549f, 0.047298763f, 0.033310328f, 0.055403575f, -0.05497939f, -0.1924453f, -0.015511203f, 0.014512101f, -0.0006989748f, 0.041398138f, -0.00055856834f, 0.03288856f, -0.029131576f, -0.028473638f, 0.04548287f, 0.009785611f, -0.03355282f, 0.019218005f, 0.06540692f, -0.047470454f, 0.011146894f, -0.015014302f, 0.0001195895f, 0.029299116f, 0.009853704f, -0.004747068f, 0.005419723f, -0.03774488f, 0.09034524f, 0.02807377f, -0.017620279f, -0.010264151f, -0.034380283f, -0.0421592f, -0.052246127f, 0.04460463f, -0.013280803f, 0.022641651f, 0.02128504f, 0.05945567f, 0.0092460085f, 0.06888296f, 0.037704065f, 0.011812303f, 0.011911113f, -0.008222946f, -0.004110362f, -0.038016323f, 0.06676937f, 0.049454648f, 0.010072975f, -0.014109628f, 0.015898496f, -0.031166524f, 0.066287555f, -0.049338896f, -0.008907222f, -0.015819822f, -0.0023257479f, -0.01706609f, 0.0032757372f, 0.04267392f, -0.03174479f, -0.040324297f, -0.016068993f, -0.01688681f, 0.014808148f, -0.06674557f, -0.048102837f, -0.0075412435f, -0.061433163f, -0.08933173f, -0.059101462f, -0.007309807f, 0.016661404f, 0.008610699f, 0.0031128363f, -0.03034967f, -0.086202f, -0.010325004f, -0.079401426f, -0.007959182f, 0.008080849f, -0.0009768362f, 0.0098044565f, 0.0059459456f, -0.033020113f, 0.03079281f, -0.016224198f, -0.0069276947f, -0.022088243f, 0.053536877f, -0.007127817f, -0.075861394f, -0.016762285f, 0.036246397f, -0.016055439f, -0.061785895f, -0.010230954f, 0.044536915f, 0.027161373f, -0.021790888f, -0.00919533f, 0.016797764f, -0.0036606044f, 0.0052227704f, -0.041441847f, -0.02269631f, -0.039144583f, -0.01696401f, -0.0019825585f, 0.016769549f, 0.017474892f, 0.034908652f, 0.00885279f, 0.019466847f, -0.009057586f, -0.049402766f, -0.04418185f, -0.0029511694f, -0.03630305f, 0.018779695f, 0.03587514f, 0.037279766f, -0.010209772f, 0.014538728f, 0.035672426f, -0.026574668f, 0.03040368f, -0.029156659f, -0.028522922f, -0.020042064f, -0.0010698038f, 0.035795875f, 0.0010927712f, 0.025416272f, -0.03055805f, -0.043293457f, 0.01574508f, 0.017055217f, 0.024232604f, 0.02867954f, -0.024631722f, -0.035441514f, -0.005252171f, -0.022533981f, -0.027001804f, -0.03360417f, -0.05090403f, 0.007828475f, 0.018258514f, 0.016239911f, 0.014594524f, 0.025518222f, -0.0063237436f, 0.029168043f, -0.007159058f, 0.037124336f, -0.0089855045f, -0.02801681f, -0.028586973f, 0.03593993f, -0.03631711f, -0.005892082f, -0.06832201f, 0.0023296238f, -0.036638744f, -0.04390342f, -0.024667945f, 0.010907139f, 0.06549355f, -0.022986349f, -0.038677156f, -0.0024060511f, 0.02447257f, -0.011409948f, -0.013240635f, -0.015483653f, -0.055167433f, -0.044166107f, -0.027221473f, 0.014140165f, -0.059623666f, -0.042023275f, -0.030740714f, 0.0062501747f, -0.0076187537f, -0.010906515f, 0.0414775f, 0.024141293f, -0.020332864f, 0.0077976333f, 0.016275562f, -0.019094491f, -0.039975278f, -0.043001555f, 0.030417792f, -0.029495101f, -0.056663826f, -0.06774065f, -0.011268121f, 0.059722953f, -0.024014011f, 0.036179792f, 0.03283652f, -0.0073126033f, 0.050435204f, -0.020500544f, -0.0024176145f, -0.001902186f, -0.09677218f, 0.029068207f, 0.008159681f, 0.019435108f, 0.0026944464f, -0.033500433f, 0.028757827f, -0.030461578f, -0.0701456f, -0.026135994f, 0.0007867077f, -0.07177861f, -0.035488687f, -0.019165654f, 0.0047632656f, 0.008479601f, -0.033569243f, 0.041151814f, -0.005161757f, 0.0019882524f, 0.009564194f, -0.002049775f, 0.02334226f, 0.020109816f, 0.034485858f, 0.005972083f, -0.051441193f, -0.0033910417f, -0.024709329f, -0.05858432f, -0.050684202f, -0.008739069f, 0.01213101f, 0.017853834f, -0.01186222f, -0.010111146f, -0.014916565f, -0.0333837f, -0.034493715f, 0.026123585f, 0.062978104f, -0.018774103f, 0.01954729f, -0.02123959f, 0.036594484f, 0.003135548f, 0.03426752f, -0.029400505f, 0.01445504f, -0.030669086f, -0.04674951f, -0.02697201f, -0.008070389f, -0.054435175f, 0.026792495f, -0.016074415f, -0.001848857f, -0.06703154f, 0.042610474f, 0.0128564155f, 0.07207451f, -0.003994973f, 0.011888596f, 0.060858104f, -0.07323154f, 0.012934459f, -0.035335258f, 0.008039221f, 0.00017592296f, 0.022907663f, -0.037189774f, 0.017641189f, 0.017462878f, 0.006377207f, -0.069999054f, -0.030672528f, 0.04209226f, -0.011559612f, -0.033271935f, 0.03718335f, -0.04930271f, 0.038017202f, -0.029150726f, -0.044415623f, -0.048017625f, -0.02205219f, -0.0045879134f, 0.023436114f, 0.025436575f, -0.03939051f, 0.018534118f, 0.024244227f, 0.026149787f, -0.03109975f, 0.04910171f, 0.006715126f, 0.04721946f, 0.046809472f, 0.06684658f, -0.008692967f, 0.024292277f, -0.020552648f, -0.053669658f, -0.006011257f, 0.04648838f, -0.01145663f, -0.036439717f, 0.058894597f, 0.052309547f, -0.027941948f, 0.03752281f, -0.023211876f, -0.06634406f, 0.03682019f, -0.008451707f, -0.030318735f, 0.013763061f, 0.03515636f, 0.0019505344f, 0.044409797f, 0.06321812f, 0.047560632f, 0.02972961f, -0.026281945f, 0.045051787f, 0.083847634f, 0.048552234f, -0.015484836f, 0.047600012f, 0.005292826f, -0.034635544f, 0.044796485f, 0.005120114f, 0.008120482f, 0.06619356f, 0.04134958f, 0.0299939f, 0.061018147f, 0.01294982f, 0.0019129978f, -0.01542437f, 0.028975025f, 0.0135150775f, 0.0060959323f, 0.019609537f, 0.039805252f, 0.039439272f, -0.045368515f, 0.012010011f, -0.0030124295f, -0.03810549f, 0.07011633f, 0.05169454f, -0.013307369f, 0.03384664f, 0.050064813f, 0.06358699f, 0.092375286f, -0.023948712f, -0.011122608f, -0.023389792f, -0.01089367f, -0.072955884f, 0.011382735f, -0.00049365533f, 0.006289031f, -0.0027576245f, -0.023061063f, -0.037334736f, 0.05174934f, 0.014830357f, 0.07111768f, -0.043370284f, 0.0211114f, 0.026229074f, 0.051549673f, -0.020449098f, -0.028761767f, -0.056340236f, -0.013819788f, -0.031201983f, -0.016417189f, 0.04437224f, 0.033814974f, -0.07617054f, -0.030004757f, 0.03355578f, 0.033893976f, 0.04161907f, -0.07662871f, 0.034090925f, -0.006287498f, 0.017130535f, 0.021799749f, 0.001980633f, 0.020365976f, 0.015722886f, 0.028892916f, -0.019339642f, -0.004140625f, -0.0013432358f, 0.01749709f, -0.017946852f, -0.037430957f, -0.03493011f, 0.01898053f, -0.051746882f, -0.080063455f, 0.056783423f, 0.009397634f, 0.06746937f, 0.05384734f, 0.05634174f, 0.023917384f, 0.02047884f, -0.015042805f, 0.015616555f, -0.01596429f, -0.0024477413f, -0.043456744f, 0.05966191f, 0.027344765f, -0.013544615f, 0.004189448f, 0.017755043f, -0.0425653f, 0.00033961408f, -0.051741213f, -0.010208365f, -0.026154002f, -0.061533313f, 0.061943922f, 0.05127766f, -0.0019210158f, -0.10710223f, -0.013404326f, 0.020841964f, 0.020250568f, 0.054526817f, -0.0053722737f, -0.0012832202f, -0.02237621f, 0.01115048f, -0.008320972f, 0.023736198f, -0.016879957f, 0.020373186f, 0.025859518f, -0.04249496f, 0.037658677f, -0.0956074f, -0.008250893f, -0.038240463f, -0.021572107f, -0.0052763657f})
  };

  @Test
  public void testExamples() throws OrtException, IOException, URISyntaxException {
    try(BgeBaseEn15Encoder encoder = new BgeBaseEn15Encoder()) {
      assertTrue(encoder.getModelPath().endsWith("bge-base-en-v1.5-optimized.onnx"));
      super.testExamples(EXAMPLES, encoder);
    }
  }
}
